services:
  portfolio-postgres-db:
    image: bitnami/postgresql:latest
    container_name: portfolio-postgres-db
    ports:
      - "5434:5432"
    restart: unless-stopped
    env_file:
      - .env
    environment:
      - POSTGRES_USER=${DATABASE_USER:-docker}
      - POSTGRES_PASSWORD=${DATABASE_PASSWORD:-docker}
      - POSTGRES_DB=portfolio
      - POSTGRESQL_TIMEZONE=America/Sao_Paulo
    volumes:
      - db_volume:/bitnami/postgresql
    networks:
      - local-network

  portfolio-pg-admin:
    image: dpage/pgadmin4:latest
    container_name: portfolio-pg-admin
    depends_on:
      - portfolio-postgres-db
    environment:
      - PGADMIN_DEFAULT_EMAIL=${PGADMIN_DEFAULT_EMAIL:-user@localhost.com}
      - PGADMIN_DEFAULT_PASSWORD=${PGADMIN_DEFAULT_PASSWORD:-admin}
      - TZ=America/Sao_Paulo 
    ports:
      - "8082:80"
    restart: unless-stopped
    env_file:
      - .env
    networks:
      - local-network 
  
  firebase-emulator:
    image: spine3/firebase-emulator
    container_name: firebase-emulator
    environment:
      - GCP_PROJECT=portfolio-lucas-dev
      - ENABLE_UI=true
    ports:
      - "9000:9000" # Realtime Database
      - "8080:8080" # Firestore
      - "4000:4000" # Painel do Emulator Suite
      - "9099:9099" # Authentication
      - "8085:8085" # Cloud Firestore Emulator UI (se aplic√°vel)
      - "5001:5001" # Cloud Functions
      - "9199:9199" # Storage
    stdin_open: true
    tty: true
    command:
      [
        "/bin/sh",
        "-c",
        "/entrypoint.sh && firebase emulators:start --import=/firebase/baseline-data",
      ]
    volumes:
      - ./baseline-data:/firebase/baseline-data
      - ./entrypoint.sh:/entrypoint.sh
    restart: always
      
volumes:
  db_volume:
  pgadmin_data:

networks:
  local-network:
    driver: bridge